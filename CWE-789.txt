
[레퍼런스]
- https://cwe.mitre.org/data/definitions/789.html

CWE-789에 strchr() 씨언어 함수 잘못 계산되는 버그에 대한 취약 코드와 보안 코드가 있네요.
보안 코드를 보면서 해당 버그에 대해서 이해해보도록 합시다.

strchr(':') 또는 strchr(' ')라는 함수 호출로 문자하나를 문자열 배열이나 동적 메모리 문자열 버퍼에서
위치를 찾아서 길이를 검사할 수 있습니다. strchr() 함수가 찾은 위치(pos)를 리턴합니다.
따라서 취약 함수가 char vulnbuf[cur-arg1]; 으로 할당 할 때, strchr로 찾은 위치가 긴 문자열에서
잘 찾아지지 않도록 긴 위치에서 찾아져서 10이상이 된다면 -1 이하의 음수가 배열의 할당자가 되어 전달됩니다.
이럴 경우에 버퍼 언더런이 발생하는데, 좀 더 버퍼를 쓰다보면 버퍼 오버플로우로 남용이 가능합니다.

또 malloc() 함수에서 이런 복잡한 문제가 발생하는 경우 strchr()과 어떤 관계가 있는지 살펴봄으로써
가정(assumption)된 문자열 버퍼 할당이 어떻게 오용될 수 있는지도 이해하실 수 있고 찝어내실수 있겠죠?.!.

이상.

놉이 (a.k.a x90)

