
[보안 버그 개념 정리]

1. 버퍼 오버 플로우
메모리를 정해진 버퍼 사이즈보다 넘게 쓸 수 있도록 메모리 경계 검사가 없는 경우 프로그램 흐름을 제어할 수 있도록 RET 주소를 덮어쓸 수 있는
버그를 말한다.

2. 힙 오버플로
버퍼 오버플로는 스택 오버플로를 말하는데, 힙 오버플로는 동적 메모리인 *malloc() 로 new(생성)된 힙 청크가 경계값 검사가 없이 덮어쓰기가
가능할 경우 다음 힙 청크들을 덮어써서 힙 청크 헤더 정보나 또는 힙 메모리 자체의 취약점을 악용할 수 있는 버그를 말한다.

3. 포맷 스트링 버그
*printf 개열의 함수 사용시 포맷 문자열을 사용자에게 맡겨서 전달하는 경우, 메모리의 4바이트를 덮어쓸 수 있는 취약점이 생겨
GOT+4에 fini 함수 주소를 덮어쓸 수 있어서 프로그램 흐름을 쉘코드로 바꿔 루트쉘을 획득할 수 있는 버그를 말한다.

4. 레이스 컨디션 버그
두 개의 프로세스가 공유하는 공유 자원에 동기화 코드를 적용하지 않고 개발된 안전하지 않은 코드의 경우에 A 프로세스가 다루던 공유 자원
Shm1을 두 번째 프로세스인 B 프로세스가 임의 값으로 덮어쓰기 하거나 하는 문제가 생기는데, 이런 경우 SUID 비트의 보안 문제와 결부되어
루트쉘을 획득할 수 있는 버그가 생긴다. 임시 파일을 주로 SUID로 다루게 해서 그러한 버그를 발생시킨다.

5. SQL 인젝션 버그
php, asp, jsp, SQLi 소스 코드가 SQL을 받아서 처리하는데, magic_quotes 함수로 검증이 안되고 통과하는 경우 SQL 구문을 임의로 만들어
커밋해서 동작하게 할 수 있다. 이렇게 될 때 인증우회나 데이터베이스 정보의 노출될 수 있는데 이러한 버그를 말한다. CWE-89

6. UAF
할당된 힙 메모리가 free() 함수로 해제되고 나서 참조되어 이용되는 경우에 크래시나 코드 실행이 가능한 버그를 말한다. CWE-416

7. php 인증 우회
인증이 없이 관리자 매뉴의 기능이 동작하는 경우를 말하는데, 사용자가 인증을 우회해서 관리자 php 페이지로 관리자 기능을 처리할 수 있는
CSRF와 유사한 버그를 말한다. [CWE-306]

8. 비초기화 메모리 버그
포인터로 동작하는 int나 char 버퍼가 초기화되지 않은 체로 사용되는 경우 해당 메모리 영역이 참조되는 경우에 익스플로잇테이젼 기법을 통해서
쉘코드를 실행할 수 있는 버그를 말한다. ([1])

9. 패스 트레버셜
php 소스코드에서 파일이나 디렉토리 경로를 상대 경로로 사용하는 경우 ../../../../etc/passwd와 같이 ../ 문자열을 사용해 디렉토리를 상위
디렉토리로 이동해서 // 최상위 디렉토리에서부터 원하는 시스템의 경로에 있는 접근 권한이 있는 파일의 내용을 노출시킬 수 있는 취약점을
말한다.

10. RCE
원격 코드 실행 취약점으로 php의 system()/passthru()/exec()/shell_exec() 함수에 의해서 인자가 검증되지 않고 전달받은 인자로 동작하는
경우에 시스템 명령어를 원격지에서 실행할 수 있는 버그를 의미한다.

11. 스택 재킹
리눅스 커널 해킹 기법 중 하나로 3단계 공격으로 구성된다. 이 공격은 커널 스택 메모리를 노출하거나 권한 객체를 덮어써서 루트쉘을 획득하는
LPE가 가능하게 되는 버그 공격이다. ([3])

12. ioctl 버그
ioctl은 유저랜드의 사용자가 커널랜드의 커널 드라이버나 모듈 또는 커널 코드에 서비스를 요청하는 경우에 데이터를 전송하고 주고받기 위해
ioctl 명령어와 함께 동작시키는 것을 의미하는데, 이 ioctl()의 명령어를 처리하는 버퍼가 적절하게 검증되지 않는 경우에 버퍼 오버플로나
커널 메모리 공격이 가능한 취약점이나, 권한 남용 버그가 발생할 수 있는데, 이것을 ioctl버그라 한다.

13. NULL 포인터 역참조
리눅스 커널에서 NLLL(0x0)주소 인근 주소에 커널 쉘코드를 올려놓고, NULL 주소가 호출되는 NULL() 취약 커널 함수 호출을 공격하는 경우
커널 권한으로 현재 쉘을 실행해 루트쉘을 획득할 수 있는 버그를 말한다. 리눅스 커널에는 가장 많이 나오는 취약점 타입 중 하나다. CWE-476

14. Write-what-where 버그
힙 오버플로의 일종의 힙 헤더 정보를 덮어씌워지는 경우 힙 헤더와 청크를 설정해서 임의 주소 4바이트에 4바이트 원하는 값을 덮어쓰기 할 수 있는
버그를 말한다. CWE-123

15. LFI / RFI
Local File Inclusion vs Remote File Inclusion이라는 php 보안 버그인데, 이 include() require() 두 함수로 인자를 넘겨받아 php 코드를 
사용자에게 맡기는 경우에, 로컬 시스템 상에 있는 php 코드를 실행하는 LFI와 http://로 시작하는 원격지 서버에 있는 php를 포함해서 실행하도록
동작시키는 RFI로 나뉘는 커플인 두 버그입니다.

16. 쿠키 스푸핑
쿠키 정보를 변경해 php 코드의 쿠키 정보를 변경해 인증된 기능을 이용할 수 있는 버그를 말한다.

[Common Weakness Enumeration 버그 컨셉 정리] 
([4])


[레퍼런스]
1. 비초기화 메모리 버그 개념: https://www.blackhat.com/docs/eu-15/materials/eu-15-Chen-Hey-Man-Have-You-Forgotten-To-Initialize-Your-Memory-wp.pdf
2. RCE 데모: https://www.youtube.com/watch?v=P_ZQKeXf-gM
3. StackJacking: https://jon.oberheide.org/files/summercon11-stackjacking.pdf
4. CWE: https://cwe.mitre.org/data/definitions/1000.html
5. CWE TOP 25: https://cwe.mitre.org/top25/archive/2021/2021_cwe_top25.html
6. 취약점 예제 코드와 보안 코딩: https://blog.naver.com/neos_rtos/220164190569
